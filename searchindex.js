Search.setIndex({"alltitles": {"API": [[36, null]], "Benchmarking": [[32, null]], "Configuration": [[33, null]], "Datasets": [[36, null]], "Entrypoints": [[34, null], [36, null]], "Future Work": [[35, null], [36, null]], "Getting Started": [[36, null]], "Installation": [[40, "installation"]], "Known Issues": [[37, null]], "MemMap Datasets": [[38, null]], "MemMapDataset Index Generator": [[38, "memmapdataset-index-generator"]], "Model Cards": [[39, null]], "Module contents": [[0, "module-modalities"], [1, "module-modalities.checkpointing"], [2, "module-modalities.checkpointing.fsdp"], [3, "module-modalities.checkpointing.torch"], [4, "module-modalities.config"], [5, "module-modalities.dataloader"], [6, "module-modalities.dataloader.open_gptx_dataset"], [7, "module-modalities.inference"], [8, "module-modalities.inference.text"], [9, "module-modalities.logging_broker"], [10, "module-modalities.logging_broker.subscriber_impl"], [11, "module-modalities.models"], [12, "module-modalities.models.coca"], [13, "module-modalities.models.components"], [14, "module-modalities.models.gpt2"], [15, "module-modalities.models.huggingface"], [16, "module-modalities.models.huggingface_adapters"], [17, "module-modalities.models.mamba"], [18, "module-modalities.models.mamba.ops"], [19, "module-modalities.models.mamba.ops.triton"], [20, "module-modalities.models.mamba.utils"], [21, "module-modalities.models.vision_transformer"], [22, "module-modalities.nn"], [23, "module-modalities.nn.model_initialization"], [24, "module-modalities.optimizers"], [25, "module-modalities.registry"], [26, "module-modalities.running_env"], [27, "module-modalities.running_env.fsdp"], [28, "module-modalities.tokenization"], [29, "module-modalities.training"], [30, "module-modalities.training.gradient_clipping"]], "Packed Data Format": [[38, "packed-data-format"]], "Packed Dataset Generator": [[38, "packed-dataset-generator"]], "Pydantic and ClassResolver": [[33, "pydantic-and-classresolver"]], "Quickstart": [[40, null]], "Setup Dataset": [[40, "setup-dataset"]], "Submodules": [[0, "submodules"], [1, "submodules"], [2, "submodules"], [3, "submodules"], [4, "submodules"], [5, "submodules"], [6, "submodules"], [7, "submodules"], [8, "submodules"], [9, "submodules"], [10, "submodules"], [11, "submodules"], [12, "submodules"], [13, "submodules"], [14, "submodules"], [15, "submodules"], [16, "submodules"], [17, "submodules"], [18, "submodules"], [19, "submodules"], [20, "submodules"], [21, "submodules"], [22, "submodules"], [23, "submodules"], [24, "submodules"], [25, "submodules"], [26, "submodules"], [27, "submodules"], [28, "submodules"], [30, "submodules"]], "Subpackages": [[0, "subpackages"], [1, "subpackages"], [5, "subpackages"], [7, "subpackages"], [9, "subpackages"], [11, "subpackages"], [17, "subpackages"], [18, "subpackages"], [22, "subpackages"], [26, "subpackages"], [29, "subpackages"]], "Training": [[40, "training"]], "VSCode Setup": [[36, null], [41, null]], "Welcome to Modalities\u2019 documentation!": [[36, null]], "modalities": [[31, null]], "modalities package": [[0, null]], "modalities.activation_checkpointing module": [[0, "modalities-activation-checkpointing-module"]], "modalities.batch module": [[0, "modalities-batch-module"]], "modalities.checkpointing package": [[1, null]], "modalities.checkpointing.checkpoint_conversion module": [[1, "modalities-checkpointing-checkpoint-conversion-module"]], "modalities.checkpointing.checkpoint_loading module": [[1, "modalities-checkpointing-checkpoint-loading-module"]], "modalities.checkpointing.checkpoint_saving module": [[1, "modalities-checkpointing-checkpoint-saving-module"]], "modalities.checkpointing.checkpoint_saving_execution module": [[1, "modalities-checkpointing-checkpoint-saving-execution-module"]], "modalities.checkpointing.checkpoint_saving_instruction module": [[1, "module-modalities.checkpointing.checkpoint_saving_instruction"]], "modalities.checkpointing.checkpoint_saving_strategies module": [[1, "modalities-checkpointing-checkpoint-saving-strategies-module"]], "modalities.checkpointing.fsdp package": [[2, null]], "modalities.checkpointing.fsdp.fsdp_checkpoint_loading module": [[2, "modalities-checkpointing-fsdp-fsdp-checkpoint-loading-module"]], "modalities.checkpointing.fsdp.fsdp_checkpoint_saving module": [[2, "modalities-checkpointing-fsdp-fsdp-checkpoint-saving-module"]], "modalities.checkpointing.torch package": [[3, null]], "modalities.checkpointing.torch.torch_checkpoint_loading module": [[3, "modalities-checkpointing-torch-torch-checkpoint-loading-module"]], "modalities.checkpointing.torch.torch_checkpoint_saving module": [[3, "modalities-checkpointing-torch-torch-checkpoint-saving-module"]], "modalities.config package": [[4, null]], "modalities.config.component_factory module": [[4, "modalities-config-component-factory-module"]], "modalities.config.config module": [[4, "modalities-config-config-module"]], "modalities.config.instantiation_models module": [[4, "modalities-config-instantiation-models-module"]], "modalities.config.lookup_enum module": [[4, "module-modalities.config.lookup_enum"]], "modalities.config.pydanctic_if_types module": [[4, "modalities-config-pydanctic-if-types-module"]], "modalities.config.utils module": [[4, "modalities-config-utils-module"]], "modalities.dataloader package": [[5, null]], "modalities.dataloader.create_index module": [[5, "modalities-dataloader-create-index-module"]], "modalities.dataloader.create_packed_data module": [[5, "modalities-dataloader-create-packed-data-module"]], "modalities.dataloader.dataloader module": [[5, "modalities-dataloader-dataloader-module"]], "modalities.dataloader.dataloader_factory module": [[5, "modalities-dataloader-dataloader-factory-module"]], "modalities.dataloader.dataset module": [[5, "modalities-dataloader-dataset-module"]], "modalities.dataloader.dataset_factory module": [[5, "modalities-dataloader-dataset-factory-module"]], "modalities.dataloader.large_file_lines_reader module": [[5, "module-modalities.dataloader.large_file_lines_reader"]], "modalities.dataloader.open_gptx_dataset package": [[6, null]], "modalities.dataloader.open_gptx_dataset.mmap_dataset module": [[6, "modalities-dataloader-open-gptx-dataset-mmap-dataset-module"]], "modalities.dataloader.open_gptx_dataset.open_gptx_dataset module": [[6, "modalities-dataloader-open-gptx-dataset-open-gptx-dataset-module"]], "modalities.dataloader.samplers module": [[5, "modalities-dataloader-samplers-module"]], "modalities.evaluator module": [[0, "modalities-evaluator-module"]], "modalities.exceptions module": [[0, "module-modalities.exceptions"]], "modalities.gym module": [[0, "modalities-gym-module"]], "modalities.inference package": [[7, null]], "modalities.inference.inference module": [[7, "modalities-inference-inference-module"]], "modalities.inference.text package": [[8, null]], "modalities.inference.text.config module": [[8, "modalities-inference-text-config-module"]], "modalities.inference.text.inference_component module": [[8, "modalities-inference-text-inference-component-module"]], "modalities.logging_broker package": [[9, null]], "modalities.logging_broker.message_broker module": [[9, "module-modalities.logging_broker.message_broker"]], "modalities.logging_broker.messages module": [[9, "module-modalities.logging_broker.messages"]], "modalities.logging_broker.publisher module": [[9, "module-modalities.logging_broker.publisher"]], "modalities.logging_broker.subscriber module": [[9, "module-modalities.logging_broker.subscriber"]], "modalities.logging_broker.subscriber_impl package": [[10, null]], "modalities.logging_broker.subscriber_impl.batch_progress_subscriber module": [[10, "modalities-logging-broker-subscriber-impl-batch-progress-subscriber-module"]], "modalities.logging_broker.subscriber_impl.results_subscriber module": [[10, "modalities-logging-broker-subscriber-impl-results-subscriber-module"]], "modalities.logging_broker.subscriber_impl.subscriber_factory module": [[10, "modalities-logging-broker-subscriber-impl-subscriber-factory-module"]], "modalities.loss_functions module": [[0, "modalities-loss-functions-module"]], "modalities.models package": [[11, null]], "modalities.models.coca package": [[12, null]], "modalities.models.coca.attention_pooling module": [[12, "modalities-models-coca-attention-pooling-module"]], "modalities.models.coca.coca_model module": [[12, "modalities-models-coca-coca-model-module"]], "modalities.models.coca.collator module": [[12, "modalities-models-coca-collator-module"]], "modalities.models.coca.multi_modal_decoder module": [[12, "modalities-models-coca-multi-modal-decoder-module"]], "modalities.models.coca.text_decoder module": [[12, "modalities-models-coca-text-decoder-module"]], "modalities.models.components package": [[13, null]], "modalities.models.components.layer_norms module": [[13, "modalities-models-components-layer-norms-module"]], "modalities.models.gpt2 package": [[14, null]], "modalities.models.gpt2.collator module": [[14, "modalities-models-gpt2-collator-module"]], "modalities.models.gpt2.gpt2_model module": [[14, "modalities-models-gpt2-gpt2-model-module"]], "modalities.models.gpt2.pretrained_gpt_model module": [[14, "modalities-models-gpt2-pretrained-gpt-model-module"]], "modalities.models.huggingface package": [[15, null]], "modalities.models.huggingface.huggingface_model module": [[15, "modalities-models-huggingface-huggingface-model-module"]], "modalities.models.huggingface_adapters package": [[16, null]], "modalities.models.huggingface_adapters.hf_adapter module": [[16, "modalities-models-huggingface-adapters-hf-adapter-module"]], "modalities.models.mamba package": [[17, null]], "modalities.models.mamba.mamba_block module": [[17, "modalities-models-mamba-mamba-block-module"]], "modalities.models.mamba.mamba_config module": [[17, "modalities-models-mamba-mamba-config-module"]], "modalities.models.mamba.mamba_model module": [[17, "modalities-models-mamba-mamba-model-module"]], "modalities.models.mamba.ops package": [[18, null]], "modalities.models.mamba.ops.selective_scan_interface module": [[18, "modalities-models-mamba-ops-selective-scan-interface-module"]], "modalities.models.mamba.ops.triton package": [[19, null]], "modalities.models.mamba.ops.triton.layernorm module": [[19, "modalities-models-mamba-ops-triton-layernorm-module"]], "modalities.models.mamba.ops.triton.selective_state_update module": [[19, "modalities-models-mamba-ops-triton-selective-state-update-module"]], "modalities.models.mamba.utils package": [[20, null]], "modalities.models.mamba.utils.generation module": [[20, "modalities-models-mamba-utils-generation-module"]], "modalities.models.model module": [[11, "modalities-models-model-module"]], "modalities.models.model_factory module": [[11, "modalities-models-model-factory-module"]], "modalities.models.utils module": [[11, "modalities-models-utils-module"]], "modalities.models.vision_transformer package": [[21, null]], "modalities.models.vision_transformer.vision_transformer_model module": [[21, "modalities-models-vision-transformer-vision-transformer-model-module"]], "modalities.nn package": [[22, null]], "modalities.nn.attention module": [[22, "modalities-nn-attention-module"]], "modalities.nn.mlp module": [[22, "modalities-nn-mlp-module"]], "modalities.nn.model_initialization package": [[23, null]], "modalities.nn.model_initialization.composed_initialization module": [[23, "modalities-nn-model-initialization-composed-initialization-module"]], "modalities.nn.model_initialization.initialization_if module": [[23, "modalities-nn-model-initialization-initialization-if-module"]], "modalities.nn.model_initialization.initialization_routines module": [[23, "modalities-nn-model-initialization-initialization-routines-module"]], "modalities.nn.model_initialization.parameter_name_filters module": [[23, "modalities-nn-model-initialization-parameter-name-filters-module"]], "modalities.optimizers package": [[24, null]], "modalities.optimizers.lr_schedulers module": [[24, "modalities-optimizers-lr-schedulers-module"]], "modalities.optimizers.optimizer_factory module": [[24, "modalities-optimizers-optimizer-factory-module"]], "modalities.registry package": [[25, null]], "modalities.registry.components module": [[25, "modalities-registry-components-module"]], "modalities.registry.registry module": [[25, "modalities-registry-registry-module"]], "modalities.running_env package": [[26, null]], "modalities.running_env.cuda_env module": [[26, "modalities-running-env-cuda-env-module"]], "modalities.running_env.env_utils module": [[26, "modalities-running-env-env-utils-module"]], "modalities.running_env.fsdp package": [[27, null]], "modalities.running_env.fsdp.fsdp_auto_wrapper module": [[27, "modalities-running-env-fsdp-fsdp-auto-wrapper-module"]], "modalities.running_env.fsdp.reducer module": [[27, "modalities-running-env-fsdp-reducer-module"]], "modalities.tokenization package": [[28, null]], "modalities.tokenization.tokenizer_wrapper module": [[28, "modalities-tokenization-tokenizer-wrapper-module"]], "modalities.trainer module": [[0, "modalities-trainer-module"]], "modalities.training package": [[29, null]], "modalities.training.gradient_clipping package": [[30, null]], "modalities.training.gradient_clipping.fsdp_gradient_clipper module": [[30, "modalities-training-gradient-clipping-fsdp-gradient-clipper-module"]], "modalities.training.gradient_clipping.fsdp_gradient_clipper_config module": [[30, "modalities-training-gradient-clipping-fsdp-gradient-clipper-config-module"]], "modalities.training.gradient_clipping.gradient_clipper module": [[30, "modalities-training-gradient-clipping-gradient-clipper-module"]], "modalities.util module": [[0, "modalities-util-module"]]}, "docnames": ["api/modalities", "api/modalities.checkpointing", "api/modalities.checkpointing.fsdp", "api/modalities.checkpointing.torch", "api/modalities.config", "api/modalities.dataloader", "api/modalities.dataloader.open_gptx_dataset", "api/modalities.inference", "api/modalities.inference.text", "api/modalities.logging_broker", "api/modalities.logging_broker.subscriber_impl", "api/modalities.models", "api/modalities.models.coca", "api/modalities.models.components", "api/modalities.models.gpt2", "api/modalities.models.huggingface", "api/modalities.models.huggingface_adapters", "api/modalities.models.mamba", "api/modalities.models.mamba.ops", "api/modalities.models.mamba.ops.triton", "api/modalities.models.mamba.utils", "api/modalities.models.vision_transformer", "api/modalities.nn", "api/modalities.nn.model_initialization", "api/modalities.optimizers", "api/modalities.registry", "api/modalities.running_env", "api/modalities.running_env.fsdp", "api/modalities.tokenization", "api/modalities.training", "api/modalities.training.gradient_clipping", "api/modules", "benchmarking", "configuration", "entrypoints", "future_work", "index", "known_issues", "memmap", "model_cards", "quickstart", "vs_code_setup"], "envversion": {"sphinx": 62, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1}, "filenames": ["api/modalities.rst", "api/modalities.checkpointing.rst", "api/modalities.checkpointing.fsdp.rst", "api/modalities.checkpointing.torch.rst", "api/modalities.config.rst", "api/modalities.dataloader.rst", "api/modalities.dataloader.open_gptx_dataset.rst", "api/modalities.inference.rst", "api/modalities.inference.text.rst", "api/modalities.logging_broker.rst", "api/modalities.logging_broker.subscriber_impl.rst", "api/modalities.models.rst", "api/modalities.models.coca.rst", "api/modalities.models.components.rst", "api/modalities.models.gpt2.rst", "api/modalities.models.huggingface.rst", "api/modalities.models.huggingface_adapters.rst", "api/modalities.models.mamba.rst", "api/modalities.models.mamba.ops.rst", "api/modalities.models.mamba.ops.triton.rst", "api/modalities.models.mamba.utils.rst", "api/modalities.models.vision_transformer.rst", "api/modalities.nn.rst", "api/modalities.nn.model_initialization.rst", "api/modalities.optimizers.rst", "api/modalities.registry.rst", "api/modalities.running_env.rst", "api/modalities.running_env.fsdp.rst", "api/modalities.tokenization.rst", "api/modalities.training.rst", "api/modalities.training.gradient_clipping.rst", "api/modules.rst", "benchmarking.rst", "configuration.rst", "entrypoints.rst", "future_work.rst", "index.rst", "known_issues.rst", "memmap.rst", "model_cards.rst", "quickstart.rst", "vs_code_setup.rst"], "indexentries": {"add_subscriber() (modalities.logging_broker.message_broker.messagebroker method)": [[9, "modalities.logging_broker.message_broker.MessageBroker.add_subscriber", false]], "add_subscriber() (modalities.logging_broker.message_broker.messagebrokerif method)": [[9, "modalities.logging_broker.message_broker.MessageBrokerIF.add_subscriber", false]], "basereader (class in modalities.dataloader.large_file_lines_reader)": [[5, "modalities.dataloader.large_file_lines_reader.BaseReader", false]], "batch_progress_update (modalities.logging_broker.messages.messagetypes attribute)": [[9, "modalities.logging_broker.messages.MessageTypes.BATCH_PROGRESS_UPDATE", false]], "batchprogressupdate (class in modalities.logging_broker.messages)": [[9, "modalities.logging_broker.messages.BatchProgressUpdate", false]], "batchstateerror": [[0, "modalities.exceptions.BatchStateError", false]], "checkpointingerror": [[0, "modalities.exceptions.CheckpointingError", false]], "checkpointinginstruction (class in modalities.checkpointing.checkpoint_saving_instruction)": [[1, "modalities.checkpointing.checkpoint_saving_instruction.CheckpointingInstruction", false]], "checkpoints_to_delete (modalities.checkpointing.checkpoint_saving_instruction.checkpointinginstruction attribute)": [[1, "modalities.checkpointing.checkpoint_saving_instruction.CheckpointingInstruction.checkpoints_to_delete", false]], "configerror": [[0, "modalities.exceptions.ConfigError", false]], "consume_dict() (modalities.logging_broker.subscriber.messagesubscriberif method)": [[9, "modalities.logging_broker.subscriber.MessageSubscriberIF.consume_dict", false]], "consume_message() (modalities.logging_broker.subscriber.messagesubscriberif method)": [[9, "modalities.logging_broker.subscriber.MessageSubscriberIF.consume_message", false]], "dataloader_tag (modalities.logging_broker.messages.batchprogressupdate attribute)": [[9, "modalities.logging_broker.messages.BatchProgressUpdate.dataloader_tag", false]], "datasetnotfounderror": [[0, "modalities.exceptions.DatasetNotFoundError", false]], "default_index_path() (modalities.dataloader.large_file_lines_reader.largefilelinesreader static method)": [[5, "modalities.dataloader.large_file_lines_reader.LargeFileLinesReader.default_index_path", false]], "distribute_message() (modalities.logging_broker.message_broker.messagebroker method)": [[9, "modalities.logging_broker.message_broker.MessageBroker.distribute_message", false]], "distribute_message() (modalities.logging_broker.message_broker.messagebrokerif method)": [[9, "modalities.logging_broker.message_broker.MessageBrokerIF.distribute_message", false]], "error_message (modalities.logging_broker.messages.messagetypes attribute)": [[9, "modalities.logging_broker.messages.MessageTypes.ERROR_MESSAGE", false]], "evaluation (modalities.logging_broker.messages.experimentstatus attribute)": [[9, "modalities.logging_broker.messages.ExperimentStatus.EVALUATION", false]], "evaluation_result (modalities.logging_broker.messages.messagetypes attribute)": [[9, "modalities.logging_broker.messages.MessageTypes.EVALUATION_RESULT", false]], "experiment_status (modalities.logging_broker.messages.batchprogressupdate attribute)": [[9, "modalities.logging_broker.messages.BatchProgressUpdate.experiment_status", false]], "experimentstatus (class in modalities.logging_broker.messages)": [[9, "modalities.logging_broker.messages.ExperimentStatus", false]], "global_rank (modalities.logging_broker.messages.message attribute)": [[9, "modalities.logging_broker.messages.Message.global_rank", false]], "high_level_progress_update (modalities.logging_broker.messages.messagetypes attribute)": [[9, "modalities.logging_broker.messages.MessageTypes.HIGH_LEVEL_PROGRESS_UPDATE", false]], "largefilelinesreader (class in modalities.dataloader.large_file_lines_reader)": [[5, "modalities.dataloader.large_file_lines_reader.LargeFileLinesReader", false]], "local_rank (modalities.logging_broker.messages.message attribute)": [[9, "modalities.logging_broker.messages.Message.local_rank", false]], "lookupenum (class in modalities.config.lookup_enum)": [[4, "modalities.config.lookup_enum.LookupEnum", false]], "message (class in modalities.logging_broker.messages)": [[9, "modalities.logging_broker.messages.Message", false]], "message_type (modalities.logging_broker.messages.message attribute)": [[9, "modalities.logging_broker.messages.Message.message_type", false]], "messagebroker (class in modalities.logging_broker.message_broker)": [[9, "modalities.logging_broker.message_broker.MessageBroker", false]], "messagebrokerif (class in modalities.logging_broker.message_broker)": [[9, "modalities.logging_broker.message_broker.MessageBrokerIF", false]], "messagepublisher (class in modalities.logging_broker.publisher)": [[9, "modalities.logging_broker.publisher.MessagePublisher", false]], "messagepublisherif (class in modalities.logging_broker.publisher)": [[9, "modalities.logging_broker.publisher.MessagePublisherIF", false]], "messagesubscriberif (class in modalities.logging_broker.subscriber)": [[9, "modalities.logging_broker.subscriber.MessageSubscriberIF", false]], "messagetypes (class in modalities.logging_broker.messages)": [[9, "modalities.logging_broker.messages.MessageTypes", false]], "modalities": [[0, "module-modalities", false]], "modalities.checkpointing": [[1, "module-modalities.checkpointing", false]], "modalities.checkpointing.checkpoint_saving_instruction": [[1, "module-modalities.checkpointing.checkpoint_saving_instruction", false]], "modalities.checkpointing.fsdp": [[2, "module-modalities.checkpointing.fsdp", false]], "modalities.checkpointing.torch": [[3, "module-modalities.checkpointing.torch", false]], "modalities.config": [[4, "module-modalities.config", false]], "modalities.config.lookup_enum": [[4, "module-modalities.config.lookup_enum", false]], "modalities.dataloader": [[5, "module-modalities.dataloader", false]], "modalities.dataloader.large_file_lines_reader": [[5, "module-modalities.dataloader.large_file_lines_reader", false]], "modalities.dataloader.open_gptx_dataset": [[6, "module-modalities.dataloader.open_gptx_dataset", false]], "modalities.exceptions": [[0, "module-modalities.exceptions", false]], "modalities.inference": [[7, "module-modalities.inference", false]], "modalities.inference.text": [[8, "module-modalities.inference.text", false]], "modalities.logging_broker": [[9, "module-modalities.logging_broker", false]], "modalities.logging_broker.message_broker": [[9, "module-modalities.logging_broker.message_broker", false]], "modalities.logging_broker.messages": [[9, "module-modalities.logging_broker.messages", false]], "modalities.logging_broker.publisher": [[9, "module-modalities.logging_broker.publisher", false]], "modalities.logging_broker.subscriber": [[9, "module-modalities.logging_broker.subscriber", false]], "modalities.logging_broker.subscriber_impl": [[10, "module-modalities.logging_broker.subscriber_impl", false]], "modalities.models": [[11, "module-modalities.models", false]], "modalities.models.coca": [[12, "module-modalities.models.coca", false]], "modalities.models.components": [[13, "module-modalities.models.components", false]], "modalities.models.gpt2": [[14, "module-modalities.models.gpt2", false]], "modalities.models.huggingface": [[15, "module-modalities.models.huggingface", false]], "modalities.models.huggingface_adapters": [[16, "module-modalities.models.huggingface_adapters", false]], "modalities.models.mamba": [[17, "module-modalities.models.mamba", false]], "modalities.models.mamba.ops": [[18, "module-modalities.models.mamba.ops", false]], "modalities.models.mamba.ops.triton": [[19, "module-modalities.models.mamba.ops.triton", false]], "modalities.models.mamba.utils": [[20, "module-modalities.models.mamba.utils", false]], "modalities.models.vision_transformer": [[21, "module-modalities.models.vision_transformer", false]], "modalities.nn": [[22, "module-modalities.nn", false]], "modalities.nn.model_initialization": [[23, "module-modalities.nn.model_initialization", false]], "modalities.optimizers": [[24, "module-modalities.optimizers", false]], "modalities.registry": [[25, "module-modalities.registry", false]], "modalities.running_env": [[26, "module-modalities.running_env", false]], "modalities.running_env.fsdp": [[27, "module-modalities.running_env.fsdp", false]], "modalities.tokenization": [[28, "module-modalities.tokenization", false]], "modalities.training": [[29, "module-modalities.training", false]], "modalities.training.gradient_clipping": [[30, "module-modalities.training.gradient_clipping", false]], "module": [[0, "module-modalities", false], [0, "module-modalities.exceptions", false], [1, "module-modalities.checkpointing", false], [1, "module-modalities.checkpointing.checkpoint_saving_instruction", false], [2, "module-modalities.checkpointing.fsdp", false], [3, "module-modalities.checkpointing.torch", false], [4, "module-modalities.config", false], [4, "module-modalities.config.lookup_enum", false], [5, "module-modalities.dataloader", false], [5, "module-modalities.dataloader.large_file_lines_reader", false], [6, "module-modalities.dataloader.open_gptx_dataset", false], [7, "module-modalities.inference", false], [8, "module-modalities.inference.text", false], [9, "module-modalities.logging_broker", false], [9, "module-modalities.logging_broker.message_broker", false], [9, "module-modalities.logging_broker.messages", false], [9, "module-modalities.logging_broker.publisher", false], [9, "module-modalities.logging_broker.subscriber", false], [10, "module-modalities.logging_broker.subscriber_impl", false], [11, "module-modalities.models", false], [12, "module-modalities.models.coca", false], [13, "module-modalities.models.components", false], [14, "module-modalities.models.gpt2", false], [15, "module-modalities.models.huggingface", false], [16, "module-modalities.models.huggingface_adapters", false], [17, "module-modalities.models.mamba", false], [18, "module-modalities.models.mamba.ops", false], [19, "module-modalities.models.mamba.ops.triton", false], [20, "module-modalities.models.mamba.utils", false], [21, "module-modalities.models.vision_transformer", false], [22, "module-modalities.nn", false], [23, "module-modalities.nn.model_initialization", false], [24, "module-modalities.optimizers", false], [25, "module-modalities.registry", false], [26, "module-modalities.running_env", false], [27, "module-modalities.running_env.fsdp", false], [28, "module-modalities.tokenization", false], [29, "module-modalities.training", false], [30, "module-modalities.training.gradient_clipping", false]], "num_steps_done (modalities.logging_broker.messages.batchprogressupdate attribute)": [[9, "modalities.logging_broker.messages.BatchProgressUpdate.num_steps_done", false]], "optimizererror": [[0, "modalities.exceptions.OptimizerError", false]], "payload (modalities.logging_broker.messages.message attribute)": [[9, "modalities.logging_broker.messages.Message.payload", false]], "publish_message() (modalities.logging_broker.publisher.messagepublisher method)": [[9, "modalities.logging_broker.publisher.MessagePublisher.publish_message", false]], "publish_message() (modalities.logging_broker.publisher.messagepublisherif method)": [[9, "modalities.logging_broker.publisher.MessagePublisherIF.publish_message", false]], "runningenverror": [[0, "modalities.exceptions.RunningEnvError", false]], "save_current (modalities.checkpointing.checkpoint_saving_instruction.checkpointinginstruction attribute)": [[1, "modalities.checkpointing.checkpoint_saving_instruction.CheckpointingInstruction.save_current", false]], "timerecorderstateerror": [[0, "modalities.exceptions.TimeRecorderStateError", false]], "train (modalities.logging_broker.messages.experimentstatus attribute)": [[9, "modalities.logging_broker.messages.ExperimentStatus.TRAIN", false]]}, "objects": {"": [[0, 0, 0, "-", "modalities"]], "modalities": [[1, 0, 0, "-", "checkpointing"], [4, 0, 0, "-", "config"], [5, 0, 0, "-", "dataloader"], [0, 0, 0, "-", "exceptions"], [7, 0, 0, "-", "inference"], [9, 0, 0, "-", "logging_broker"], [11, 0, 0, "-", "models"], [22, 0, 0, "-", "nn"], [24, 0, 0, "-", "optimizers"], [25, 0, 0, "-", "registry"], [26, 0, 0, "-", "running_env"], [28, 0, 0, "-", "tokenization"], [29, 0, 0, "-", "training"]], "modalities.checkpointing": [[1, 0, 0, "-", "checkpoint_saving_instruction"], [2, 0, 0, "-", "fsdp"], [3, 0, 0, "-", "torch"]], "modalities.checkpointing.checkpoint_saving_instruction": [[1, 1, 1, "", "CheckpointingInstruction"]], "modalities.checkpointing.checkpoint_saving_instruction.CheckpointingInstruction": [[1, 2, 1, "", "checkpoints_to_delete"], [1, 2, 1, "", "save_current"]], "modalities.config": [[4, 0, 0, "-", "lookup_enum"]], "modalities.config.lookup_enum": [[4, 1, 1, "", "LookupEnum"]], "modalities.dataloader": [[5, 0, 0, "-", "large_file_lines_reader"], [6, 0, 0, "-", "open_gptx_dataset"]], "modalities.dataloader.large_file_lines_reader": [[5, 1, 1, "", "BaseReader"], [5, 1, 1, "", "LargeFileLinesReader"]], "modalities.dataloader.large_file_lines_reader.LargeFileLinesReader": [[5, 3, 1, "", "default_index_path"]], "modalities.exceptions": [[0, 4, 1, "", "BatchStateError"], [0, 4, 1, "", "CheckpointingError"], [0, 4, 1, "", "ConfigError"], [0, 4, 1, "", "DatasetNotFoundError"], [0, 4, 1, "", "OptimizerError"], [0, 4, 1, "", "RunningEnvError"], [0, 4, 1, "", "TimeRecorderStateError"]], "modalities.inference": [[8, 0, 0, "-", "text"]], "modalities.logging_broker": [[9, 0, 0, "-", "message_broker"], [9, 0, 0, "-", "messages"], [9, 0, 0, "-", "publisher"], [9, 0, 0, "-", "subscriber"], [10, 0, 0, "-", "subscriber_impl"]], "modalities.logging_broker.message_broker": [[9, 1, 1, "", "MessageBroker"], [9, 1, 1, "", "MessageBrokerIF"]], "modalities.logging_broker.message_broker.MessageBroker": [[9, 3, 1, "", "add_subscriber"], [9, 3, 1, "", "distribute_message"]], "modalities.logging_broker.message_broker.MessageBrokerIF": [[9, 3, 1, "", "add_subscriber"], [9, 3, 1, "", "distribute_message"]], "modalities.logging_broker.messages": [[9, 1, 1, "", "BatchProgressUpdate"], [9, 1, 1, "", "ExperimentStatus"], [9, 1, 1, "", "Message"], [9, 1, 1, "", "MessageTypes"]], "modalities.logging_broker.messages.BatchProgressUpdate": [[9, 2, 1, "", "dataloader_tag"], [9, 2, 1, "", "experiment_status"], [9, 2, 1, "", "num_steps_done"]], "modalities.logging_broker.messages.ExperimentStatus": [[9, 2, 1, "", "EVALUATION"], [9, 2, 1, "", "TRAIN"]], "modalities.logging_broker.messages.Message": [[9, 2, 1, "", "global_rank"], [9, 2, 1, "", "local_rank"], [9, 2, 1, "", "message_type"], [9, 2, 1, "", "payload"]], "modalities.logging_broker.messages.MessageTypes": [[9, 2, 1, "", "BATCH_PROGRESS_UPDATE"], [9, 2, 1, "", "ERROR_MESSAGE"], [9, 2, 1, "", "EVALUATION_RESULT"], [9, 2, 1, "", "HIGH_LEVEL_PROGRESS_UPDATE"]], "modalities.logging_broker.publisher": [[9, 1, 1, "", "MessagePublisher"], [9, 1, 1, "", "MessagePublisherIF"]], "modalities.logging_broker.publisher.MessagePublisher": [[9, 3, 1, "", "publish_message"]], "modalities.logging_broker.publisher.MessagePublisherIF": [[9, 3, 1, "", "publish_message"]], "modalities.logging_broker.subscriber": [[9, 1, 1, "", "MessageSubscriberIF"]], "modalities.logging_broker.subscriber.MessageSubscriberIF": [[9, 3, 1, "", "consume_dict"], [9, 3, 1, "", "consume_message"]], "modalities.models": [[12, 0, 0, "-", "coca"], [13, 0, 0, "-", "components"], [14, 0, 0, "-", "gpt2"], [15, 0, 0, "-", "huggingface"], [16, 0, 0, "-", "huggingface_adapters"], [17, 0, 0, "-", "mamba"], [21, 0, 0, "-", "vision_transformer"]], "modalities.models.mamba": [[18, 0, 0, "-", "ops"], [20, 0, 0, "-", "utils"]], "modalities.models.mamba.ops": [[19, 0, 0, "-", "triton"]], "modalities.nn": [[23, 0, 0, "-", "model_initialization"]], "modalities.running_env": [[27, 0, 0, "-", "fsdp"]], "modalities.training": [[30, 0, 0, "-", "gradient_clipping"]]}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "attribute", "Python attribute"], "3": ["py", "method", "Python method"], "4": ["py", "exception", "Python exception"]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:attribute", "3": "py:method", "4": "py:exception"}, "terms": {"": 36, "0": [9, 33, 40, 41], "1": [33, 40, 41], "10": 40, "13": 41, "2": [40, 41], "29502": 40, "29503": 41, "3": [38, 40], "3537": 34, "3_amd64": 41, "4": [38, 41], "5": 41, "8": 38, "A": [33, 36], "By": 36, "For": [33, 34, 38, 40], "IN": 32, "If": 5, "In": [33, 41], "TO": 32, "The": [9, 33, 34, 35, 36, 38], "Then": 33, "These": 33, "To": [33, 38, 40], "With": [33, 34], "__dict__": 33, "__main__": [34, 40, 41], "__name__": 34, "_missing_": 33, "abc": [5, 9], "abov": [33, 38], "abstract": 9, "access": 33, "activ": [36, 40], "activation_checkpoint": [31, 36], "activation_kwarg": 33, "activation_resolv": 33, "ad": 33, "add": [9, 33, 34, 40, 41], "add_resolv": 33, "add_subscrib": [0, 9, 36], "adher": 36, "adopt": 36, "advis": 38, "all": [9, 33, 34, 38, 41], "allow": [33, 36], "alreadi": 35, "altern": 34, "an": [4, 5, 9, 38], "ani": 9, "annot": 33, "apt": 41, "ar": [33, 34, 38, 40], "architectur": [35, 36], "arg": 41, "argument": [33, 34], "art": 36, "assum": 38, "attent": [0, 31, 36], "attention_pool": [0, 11, 36], "attribu": 33, "audio": 35, "audiopalm": 35, "auto": 33, "base": [0, 1, 4, 5, 9, 33, 35, 41], "basemodel": 33, "baseread": [0, 5, 36], "bash": 41, "bashrc": 41, "basic": 38, "batch": [9, 31, 36], "batch_progress_subscrib": [0, 9, 36], "batch_progress_upd": [0, 9, 36], "batchprogressupd": [0, 9, 36], "batchstateerror": [0, 31, 36], "beforehand": 38, "benchmark": 36, "between": [33, 38], "bias": 37, "bin": [37, 41], "bool": 1, "both": [33, 38], "bring": 35, "broker": 9, "build_component_by_config": 33, "build_component_by_key_queri": 33, "byte": [5, 38], "bytestream": 38, "call": 34, "can": [33, 34, 35, 36, 38], "capabl": 36, "card": 36, "chang": [32, 33], "charact": 5, "check": 33, "checkpoint": [0, 31, 36], "checkpoint_convers": [0, 31, 36], "checkpoint_load": [0, 31, 36], "checkpoint_sav": [0, 31, 36], "checkpoint_saving_execut": [0, 31, 36], "checkpoint_saving_instruct": [0, 31, 36], "checkpoint_saving_strategi": [0, 31, 36], "checkpointingerror": [0, 31, 36], "checkpointinginstruct": [0, 1, 36], "checkpoints_to_delet": [0, 1, 36], "cl": 33, "class": [1, 4, 5, 9, 33], "classmethod": 33, "classresolv": 36, "clean": 36, "cli": 34, "click": 34, "click_pathlib": 34, "client": 41, "cmd": 41, "coca": [0, 11, 35, 36], "coca_model": [0, 11, 36], "code": [35, 36], "codebas": 36, "collat": [0, 11, 36], "combin": [36, 41], "command": [34, 38], "complet": 41, "compon": [0, 11, 31, 36], "component_factori": [0, 31, 36], "composed_initi": [0, 22, 36], "comprehens": 36, "comput": 9, "concaten": 38, "concret": 33, "conda": 40, "config": [0, 7, 31, 33, 34, 36, 37], "config_fil": [34, 40, 41], "config_file_path": [34, 40, 41], "config_lorem_ipsum": [33, 40, 41], "config_opt": 34, "configerror": [0, 31, 36], "configur": 36, "conjunct": 35, "consecut": 38, "consist": 38, "consol": 41, "constantlr": 33, "constantlrconfig": 33, "construct": 33, "constructor": 33, "consume_dict": [0, 9, 36], "consume_messag": [0, 9, 36], "contain": [38, 41], "content": [31, 36, 40], "contribut": 36, "control": 33, "conveni": 33, "core": 41, "correct": 33, "correspond": [33, 38], "creat": [38, 40], "create_index": [0, 31, 36], "create_packed_data": [0, 31, 36], "create_raw_index": [38, 40], "cuda12": 41, "cuda_env": [0, 31, 36], "cuda_visible_devic": [40, 41], "cudnn8": 41, "current": [9, 35], "custom": [36, 41], "cwd": 41, "data": [5, 33, 36, 40], "dataload": [0, 31, 33, 36], "dataloader_factori": [0, 31, 36], "dataloader_tag": [0, 9, 36], "dataset": [0, 31, 37], "dataset_factori": [0, 31, 36], "datasetnotfounderror": [0, 31, 36], "deb": 41, "decod": 35, "def": [33, 34], "default": 33, "default_index_path": [0, 5, 36], "defin": [5, 33], "delet": 1, "denot": 38, "depend": [33, 37], "dependeci": 33, "describ": 38, "design": 36, "dev": 41, "devcontain": 41, "devel": 41, "develop": 36, "dict": [9, 33], "differ": [33, 35, 36], "directli": 34, "directori": 38, "distribut": [9, 41], "distribute_messag": [0, 9, 36], "divers": 36, "do": 34, "do_stuff": 34, "doc": 32, "docker": 41, "dockerfil": 41, "document": 38, "doe": 34, "done": 38, "download": 41, "dpkg": 41, "dure": 33, "e": [33, 34, 38, 40, 41], "each": [33, 38], "eas": 36, "easi": [33, 36], "echo": 41, "edit": 32, "effici": 36, "either": 35, "els": 33, "enabl": [35, 36], "encod": [35, 38], "end": 38, "endpoint": [40, 41], "enhanc": 36, "entri": 34, "entry_point_do_stuff": 34, "enum": [4, 9, 33], "enumer": [4, 9], "env": 41, "env_util": [0, 31, 36], "envfil": 41, "environ": [40, 41], "error_messag": [0, 9, 36], "establish": 35, "eval": 41, "evalu": [9, 31, 36, 40], "evaluation_result": [0, 9, 36], "exampl": [33, 34, 40], "except": [31, 36], "execut": 38, "exist": 34, "experiment": 36, "experiment_statu": [0, 9, 36], "experimentstatu": [0, 9, 36], "explicit": 33, "explor": 36, "extens": [35, 36, 41], "extent": 41, "extra_kwarg": 33, "f": 34, "facilit": 36, "factor": 33, "factori": 1, "fals": [1, 34], "featur": 33, "field": 33, "file": [5, 33, 34, 36, 38, 40], "first": [38, 40], "firstli": 33, "fit": 33, "float": 33, "focal": 41, "follow": [34, 38], "form": 38, "format": [33, 36], "framework": 36, "friendli": [33, 36], "from": [33, 34, 40, 41], "fsdp": [0, 1, 26, 36], "fsdp_auto_wrapp": [0, 26, 36], "fsdp_checkpoint_load": [0, 1, 36], "fsdp_checkpoint_sav": [0, 1, 36], "fsdp_gradient_clipp": [0, 29, 36], "fsdp_gradient_clipper_config": [0, 29, 36], "full": 34, "fulli": 36, "function": 33, "further": [33, 38], "g": [34, 38, 41], "gamma": 33, "ge": 33, "gener": [9, 11, 17, 36], "get": 41, "git": 41, "github": [37, 41], "given": [5, 33], "global_rank": [0, 9, 36], "go": 33, "gpt2": [0, 11, 36], "gpt2_model": [0, 11, 36], "gpu": [40, 41], "gradient_clip": [0, 29, 36], "gradient_clipp": [0, 29, 36], "group": 34, "gym": [31, 36], "hardcod": 37, "hardtanh": 33, "have": [33, 34, 38], "header": 38, "help": [34, 38], "here": 32, "herebi": 33, "hf_adapt": [0, 11, 36], "hierarchi": 33, "high_level_progress_upd": [0, 9, 36], "hint": 33, "hold": [5, 9], "host": 41, "howev": 38, "http": 41, "huggingfac": [0, 11, 36], "huggingface_adapt": [0, 11, 36], "huggingface_model": [0, 11, 36], "i": [5, 33, 34, 35, 36, 38, 41], "idea": 35, "idx": 5, "imag": 35, "implment": 33, "import": [33, 34], "index": [5, 36], "index_path": 5, "indic": 5, "infer": [0, 31, 33, 36], "inference_compon": [0, 7, 36], "initialization_if": [0, 22, 36], "initialization_routin": [0, 22, 36], "innov": 36, "input": 33, "insid": 38, "instal": [36, 41], "instanti": 33, "instantiation_model": [0, 31, 36], "instruct": 1, "int": [1, 9, 33, 34], "integ": [34, 38], "integr": [36, 41], "integratedtermin": 41, "interfac": 9, "intern": 33, "introduc": 33, "io": 41, "ipsum": 40, "issu": 36, "its": [5, 9], "json": 41, "jsonl": [5, 38, 40], "justmycod": 41, "keep": 33, "kei": [33, 36], "known": 36, "languag": 36, "larg": [33, 36], "large_file_lines_read": [0, 31, 36], "largefilelinesread": [0, 5, 36], "launch": 41, "layer_norm": [0, 11, 36], "layernorm": [17, 18, 36], "lazili": 38, "learn": 36, "len_doc1": 38, "len_doc2": 38, "length": [5, 38], "leverag": 36, "lf": 41, "lfs_2": 41, "line": 36, "linux": 41, "list": [1, 38], "llm": [35, 36], "load": 33, "loc": 36, "local_rank": [0, 9, 36], "locat": 38, "logging_brok": [0, 31, 36], "look": 38, "lookup_enum": [0, 31, 36], "lookup_typ": 33, "lookupenum": [0, 4, 33, 36], "loop": 36, "lorem": 40, "lorem_ipsum": 40, "loss_funct": [31, 36], "lr_schedul": [0, 31, 33, 36], "m": 41, "mai": 38, "main": 34, "maintain": 36, "mainten": 36, "make": [32, 33], "mamba": [0, 11, 36], "mamba_block": [0, 11, 36], "mamba_config": [0, 11, 36], "mamba_model": [0, 11, 36], "map": 33, "mechanismn": 33, "mehdi": 37, "member": 33, "memmap": [36, 40], "memmapdataset": 36, "memori": 36, "mesasge_dict": 9, "messag": [0, 31, 36], "message_brok": [0, 31, 36], "message_typ": [0, 9, 36], "messagebrok": [0, 9, 36], "messagebrokerif": [0, 9, 36], "messagepublish": [0, 9, 36], "messagepublisherif": [0, 9, 36], "messagesubscriberif": [0, 9, 36], "messagetyp": [0, 9, 36], "minim": 36, "mix": 35, "mlp": [0, 31, 36], "mmap_dataset": [0, 5, 36], "modal": [33, 34, 35, 38, 40, 41], "model": [0, 31, 33, 36], "model_factori": [0, 31, 36], "model_initi": [0, 22, 36], "modul": [31, 33, 36, 41], "modular": 36, "most": 41, "multi": [35, 40], "multi_modal_decod": [0, 11, 36], "multimod": 36, "must": 33, "my_cli_argu": 34, "my_new_entry_point": 34, "n": 40, "name": [33, 34, 35, 41], "nativ": 36, "necessari": 38, "need": [33, 40], "network": 41, "new": [33, 34], "next": 5, "nn": [0, 31, 33, 36], "nnode": [40, 41], "none": [5, 34], "noth": 34, "notif": 9, "novel": 36, "nproc_per_nod": [40, 41], "num_steps_don": [0, 9, 36], "o": 41, "object": [1, 9], "omegaconf": 33, "onli": [34, 35], "op": [11, 17, 36], "open_gptx_dataset": [0, 5, 36], "opengptx": 37, "openssh": 41, "optim": [0, 31, 33, 36], "optimizer_factori": [0, 31, 36], "optimizererror": [0, 31, 36], "option": [5, 34, 38], "order": 32, "other": [34, 35], "our": [33, 34, 35, 36], "out": 40, "pack": [36, 40], "pack_encoded_data": [38, 40], "packag": [31, 36, 41], "packagecloud": 41, "packedmemmapdatasetcontinu": 38, "packedmemmapdatasetmegatron": 38, "parallel": 36, "paramet": [1, 5, 9, 33, 36], "parameter_name_filt": [0, 22, 36], "part": 38, "pass": [33, 34], "path": [5, 34, 37, 38, 40], "payload": [0, 9, 36], "pick": 5, "pickl": 38, "pip": 40, "place": [33, 38], "platform": 36, "point": 34, "pointer": 38, "posit": [5, 38], "positivefloat": 33, "positiveint": 33, "possibl": 33, "pretrained_gpt_model": [0, 11, 36], "principl": 36, "print": 34, "priorit": 36, "process": 36, "progress": 9, "progress_upd": 9, "project": [34, 36], "promot": 36, "propos": 36, "provid": 38, "publish": [0, 31, 36], "publish_messag": [0, 9, 36], "py": [33, 34, 40, 41], "pydanctic_if_typ": [0, 31, 36], "pydant": 36, "pyproject": 34, "python": [40, 41], "pytorch": [36, 41], "quickstart": 36, "raid": 37, "raw": 38, "raw_data_path": 5, "rdzv": [40, 41], "readabl": 36, "recent": 41, "recommend": 41, "reduc": [0, 26, 36], "reflect": 33, "refrenc": 33, "regist": 34, "register_kei": 33, "registri": [0, 31, 36], "relu": 33, "replac": [5, 33], "repres": 9, "reproduc": 33, "request": 41, "requir": [34, 38, 40], "resolv": 33, "resolverregist": 33, "resolverregistri": 33, "results_subscrib": [0, 9, 36], "return": [5, 33], "rm": 41, "rst": 32, "run": [38, 40, 41], "runarg": 41, "running_env": [0, 31, 36], "runningenverror": [0, 31, 36], "s3": 37, "same": 38, "sampl": 5, "sampler": [0, 31, 36], "save": 1, "save_curr": [0, 1, 36], "scalabl": 36, "scale": 36, "schedul": 33, "schedulerconfig": 33, "schedulertyp": 33, "script": 34, "seamlessli": [36, 41], "second": 33, "section": 38, "see": [33, 34], "segment": 38, "select": 33, "selective_scan_interfac": [11, 17, 36], "selective_state_upd": [17, 18, 36], "send": 9, "sequenc": 38, "set": [33, 40, 41], "shard": 36, "share": 41, "shell": 41, "similar": 35, "simpli": 38, "simplifi": 36, "singl": [9, 36], "size": 38, "sourc": [0, 1, 4, 5, 9, 32, 41], "special": 33, "specif": 34, "specifi": 33, "speed": 36, "src": [33, 34, 40, 41], "start": [5, 34, 38, 40], "start_doc1": 38, "start_doc2": 38, "state": [9, 36], "static": 5, "step": 33, "step_siz": 33, "steplr": 33, "steplrconfig": 33, "still": 33, "str": [9, 33], "strategi": 36, "strict": 33, "string": 33, "structur": 33, "stuff": 34, "sub": [33, 34], "subconfig": 33, "submodul": [29, 31, 36], "subpackag": [31, 36], "subscrib": [0, 31, 36], "subscriber_factori": [0, 9, 36], "subscriber_impl": [0, 9, 36], "subscript": 9, "suffix": 5, "t": 9, "take": 33, "tanh": 33, "task": 36, "team": 35, "techniqu": 36, "temp": 37, "temp_data": 37, "termin": 41, "text": [0, 5, 7, 35, 36], "text_decod": [0, 11, 36], "than": 35, "thi": [33, 34, 35, 36, 38, 41], "through": [9, 33], "timerecorderstateerror": [0, 31, 36], "tmp": 41, "todo": 39, "token": [0, 31, 36, 38], "tokenizer_wrapp": [0, 31, 36], "toml": 34, "tool": 34, "torch": [0, 1, 33, 36, 41], "torch_checkpoint_load": [0, 1, 36], "torch_checkpoint_sav": [0, 1, 36], "torchrun": [40, 41], "total_it": 33, "train": [0, 9, 31, 33, 36, 41], "train_text_docu": 37, "trainer": [31, 36], "transpar": 33, "triton": [17, 18, 36], "true": [33, 34, 41], "tupl": 38, "type": [5, 33, 34, 41], "type_hint": 33, "typevar": 9, "ubuntu": 41, "under": 36, "union": 33, "updat": 41, "us": [33, 34, 35, 40], "usag": [36, 38], "user": [33, 35, 36], "usr": 41, "util": [17, 31, 33, 36], "valid": 33, "valu": [4, 9, 33], "variabl": 40, "variou": 36, "veri": 33, "via": [33, 38], "video": 35, "vision_transform": [0, 11, 36], "vision_transformer_model": [0, 11, 36], "wai": 33, "we": [33, 34, 36, 41], "weight": 37, "well": 38, "wget": 41, "where": 38, "which": [5, 33, 34, 35, 38], "while": [33, 36], "whole": 33, "wip": 40, "work": 41, "workspacefold": 41, "would": 35, "y": 41, "yaml": [33, 34, 37, 40, 41], "you": [33, 38, 40], "your": 41}, "titles": ["modalities package", "modalities.checkpointing package", "modalities.checkpointing.fsdp package", "modalities.checkpointing.torch package", "modalities.config package", "modalities.dataloader package", "modalities.dataloader.open_gptx_dataset package", "modalities.inference package", "modalities.inference.text package", "modalities.logging_broker package", "modalities.logging_broker.subscriber_impl package", "modalities.models package", "modalities.models.coca package", "modalities.models.components package", "modalities.models.gpt2 package", "modalities.models.huggingface package", "modalities.models.huggingface_adapters package", "modalities.models.mamba package", "modalities.models.mamba.ops package", "modalities.models.mamba.ops.triton package", "modalities.models.mamba.utils package", "modalities.models.vision_transformer package", "modalities.nn package", "modalities.nn.model_initialization package", "modalities.optimizers package", "modalities.registry package", "modalities.running_env package", "modalities.running_env.fsdp package", "modalities.tokenization package", "modalities.training package", "modalities.training.gradient_clipping package", "modalities", "Benchmarking", "Configuration", "Entrypoints", "Future Work", "Welcome to Modalities\u2019 documentation!", "Known Issues", "MemMap Datasets", "Model Cards", "Quickstart", "VSCode Setup"], "titleterms": {"activation_checkpoint": 0, "api": 36, "attent": 22, "attention_pool": 12, "batch": 0, "batch_progress_subscrib": 10, "benchmark": 32, "card": 39, "checkpoint": [1, 2, 3], "checkpoint_convers": 1, "checkpoint_load": 1, "checkpoint_sav": 1, "checkpoint_saving_execut": 1, "checkpoint_saving_instruct": 1, "checkpoint_saving_strategi": 1, "classresolv": 33, "coca": 12, "coca_model": 12, "collat": [12, 14], "compon": [13, 25], "component_factori": 4, "composed_initi": 23, "config": [4, 8], "configur": 33, "content": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30], "create_index": 5, "create_packed_data": 5, "cuda_env": 26, "data": 38, "dataload": [5, 6], "dataloader_factori": 5, "dataset": [5, 36, 38, 40], "dataset_factori": 5, "document": 36, "entrypoint": [34, 36], "env_util": 26, "evalu": 0, "except": 0, "format": 38, "fsdp": [2, 27], "fsdp_auto_wrapp": 27, "fsdp_checkpoint_load": 2, "fsdp_checkpoint_sav": 2, "fsdp_gradient_clipp": 30, "fsdp_gradient_clipper_config": 30, "futur": [35, 36], "gener": [20, 38], "get": 36, "gpt2": 14, "gpt2_model": 14, "gradient_clip": 30, "gradient_clipp": 30, "gym": 0, "hf_adapt": 16, "huggingfac": 15, "huggingface_adapt": 16, "huggingface_model": 15, "index": 38, "infer": [7, 8], "inference_compon": 8, "initialization_if": 23, "initialization_routin": 23, "instal": 40, "instantiation_model": 4, "issu": 37, "known": 37, "large_file_lines_read": 5, "layer_norm": 13, "layernorm": 19, "logging_brok": [9, 10], "lookup_enum": 4, "loss_funct": 0, "lr_schedul": 24, "mamba": [17, 18, 19, 20], "mamba_block": 17, "mamba_config": 17, "mamba_model": 17, "memmap": 38, "memmapdataset": 38, "messag": 9, "message_brok": 9, "mlp": 22, "mmap_dataset": 6, "modal": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 36], "model": [11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 39], "model_factori": 11, "model_initi": 23, "modul": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30], "multi_modal_decod": 12, "nn": [22, 23], "op": [18, 19], "open_gptx_dataset": 6, "optim": 24, "optimizer_factori": 24, "pack": 38, "packag": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30], "parameter_name_filt": 23, "pretrained_gpt_model": 14, "publish": 9, "pydanctic_if_typ": 4, "pydant": 33, "quickstart": 40, "reduc": 27, "registri": 25, "results_subscrib": 10, "running_env": [26, 27], "sampler": 5, "selective_scan_interfac": 18, "selective_state_upd": 19, "setup": [36, 40, 41], "start": 36, "submodul": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 30], "subpackag": [0, 1, 5, 7, 9, 11, 17, 18, 22, 26, 29], "subscrib": 9, "subscriber_factori": 10, "subscriber_impl": 10, "text": 8, "text_decod": 12, "token": 28, "tokenizer_wrapp": 28, "torch": 3, "torch_checkpoint_load": 3, "torch_checkpoint_sav": 3, "train": [29, 30, 40], "trainer": 0, "triton": 19, "util": [0, 4, 11, 20], "vision_transform": 21, "vision_transformer_model": 21, "vscode": [36, 41], "welcom": 36, "work": [35, 36]}})